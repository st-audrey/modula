$(function () {
    console.log("ready!");
 

    $("#formContact").submit(function (e) {
        e.preventDefault();


        $form = $("#formContact");
        $formMessage = $("#formMessage");
        $name = $("#name").value;
        $firstname = $("#firstname").value;
        $email = $("exampleInputEmail1").value;
        $content = $("#text-zone").value;
        $dataString = 'name=' + $name +
                      '&email=' + $email +
                      '&firstname=' + $firstname +
                      '&content=' + $content +
                      '&g-recaptcha-response=' + grecaptcha.getResponse();


        $inputs = $form.find("input, button, textarea");
        $inputs.prop("disabled", true);

        // AJAX code to submit form.
        $request = $.ajax({
            type: "POST",
            url: $form.attr('action'),
            data: $dataString,
            dataType: 'JSON',
            cache: false,
        });
    
        $request.done(function (response) {
            // Make sure that the formMessages div has the 'success' class.
            $formMessage.removeClass('error');
            $formMessage.addClass('success');

            // Set the message text.
            if (response['success']) {
                $formMessage.text('Votre message a bien été envoyé!!!!');
            }
            else {
                $formMessage.text('Oops! An error occured and your message could not be sent.');
            }
            console.log(response);
            // Clear the form.
            $('#name').val('');
            $('#firstname').val('');
            $('#exampleInputEmail1').val('');
            $('#text-zone').val('');
        })
        $request.fail(function (data) {
            // Make sure that the formMessages div has the 'error' class.
            $formMessage.removeClass('success');
            $formMessage.addClass('error');

            // Set the message text.
            if (data.responseText !== '') {
                $formMessage.text(data.responseText);
            } else {
                $formMessage.text('Oops! An error occured and your message could not be sent.');
            }
        })        
    });
});

